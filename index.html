<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Documento Protegido — Estático</title>
<style>
  html,body{height:100%;margin:0;background:#0f1724;color:#e6eef8;font-family:Inter, Arial, sans-serif}
  #wrap{box-sizing:border-box;display:flex;flex-direction:column;height:100%;}
  header{padding:12px;display:flex;align-items:center;gap:12px;background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);border-bottom:1px solid rgba(255,255,255,0.03)}
  header h1{font-size:1rem;margin:0}
  #canvasContainer{flex:1;display:flex;align-items:center;justify-content:center;padding:18px;overflow:auto;position:relative}
  canvas{max-width:100%;height:auto;border-radius:8px;box-shadow:0 6px 24px rgba(2,6,23,0.6);background:#061226}
  *{user-select:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none}
  img,canvas{pointer-events:auto}
  #expiredOverlay{
    position:absolute;inset:0;display:flex;align-items:center;justify-content:center;
    background:linear-gradient(180deg, rgba(5,8,12,0.75), rgba(3,6,10,0.85));
    color:#ffd6d6;font-weight:700;font-size:20px;text-align:center;padding:20px;gap:12px;z-index:40;border-radius:8px;display:none;
  }
  #controls{display:flex;gap:8px;padding:12px;align-items:center}
  button{background:#0b1220;color:#cfe6ff;border:1px solid rgba(255,255,255,0.04);padding:8px 10px;border-radius:6px;cursor:pointer}
  button[disabled]{opacity:0.45;cursor:not-allowed}
  footer{font-size:12px;padding:8px 12px;color:#8ea5bf;background:linear-gradient(180deg, transparent, rgba(255,255,255,0.01))}
</style>
</head>
<body>
<div id="wrap">
  <header>
    <h1>Documento Protegido — Visualização</h1>
    <div style="margin-left:auto;font-size:13px;color:#9fbadb">Proteção: Canvas + Watermark</div>
  </header>

  <div id="canvasContainer">
    <canvas id="docCanvas" width="1200" height="800" role="img" aria-label="Documento protegido"></canvas>
    <div id="expiredOverlay" aria-hidden="true"></div>
  </div>

  <div id="controls">
    <button id="regenBtn" disabled>Reembaralhar (desativado)</button>
    <button id="toggleAnim" disabled>Animação (desativado)</button>
    <button id="downloadBtn">Baixar PNG</button>
  </div>

  <footer>⚠️ Proteção técnica não impede foto com celular.</footer>
</div>

<script>
/* ================= CONFIGURAÇÃO ================= */
/* Texto — substitua aqui (não inclua dados pessoais se for público) */
const TEXT_CONTENT = [
    "Só para você saber, não vou mais te cobrar o que você me deve por não ter feito o programa naquela noite, na 147. Você disse na frente de todo mundo que ia te pagar. Bom, cada um tem sua própria cabeça e jeito de falar. Eu me lembro de tudo daquela noite, mas você não. Você deve estar usando drogas, ou melhor, bebendo e tudo mais. Mas eu não sinto pena de você, a mulher que causou tudo isso. Você está atraindo esse ódio, essa coisa ruim. Pare de beber, isso já é alguma coisa, pelo menos você vai se lembrar para quem deve o dinheiro. Eu realmente queria sair com você naquele dia, mas você provou que não é bonita por dentro, nem muito bonita por fora, e com tudo o que disseram sobre você na casa 147, drogas, bebida em excesso, problemas, não só lá, mas em outras casas também, seu hábito de achar que tudo o que acontece é culpa daquele cara. Esquece ele, você fala dele o tempo todo, mesmo eu provando que não sou ele, você acha que ele sou eu. Bem, eu não sou esse cara. Os funcionários disseram que você não parava de falar mal dele, até duas garotas de programa disseram e elas disseram que ele nunca mais voltou lá. Acerte as contas com esse cara, ou esqueça isso de vez. Culpa? Se você tem a consciência tranquila por não me pagar, tudo bem. Quando você acha que é tarde demais, a verdade é que ainda é cedo.",
  "Só não esquece voce me deve dinheiro ainda."
];
/* DATA DE EXPIRAÇÃO (formato YYYY-MM-DD) — expira às 23:59:59 dessa data, horário local */
const EXPIRY_DATE = "2025-12-31";
/* ================================================== */

const CANVAS_WIDTH = 1200;
const CANVAS_HEIGHT = 800;
const LINE_HEIGHT = 34;
const FONT_SIZE = 22;
const WATERMARK_TEXT = 'NÃO COPIAR — CONFIDENCIAL';

const canvas = document.getElementById('docCanvas');
const ctx = canvas.getContext('2d', {alpha:false});
canvas.width = CANVAS_WIDTH;
canvas.height = CANVAS_HEIGHT;

/* parse YYYY-MM-DD -> Date local às 23:59:59 */
function parseExpiryDateLocal(dateStr) {
  const parts = dateStr.split('-');
  if (parts.length !== 3) return null;
  const y = parseInt(parts[0],10);
  const m = parseInt(parts[1],10) - 1;
  const d = parseInt(parts[2],10);
  return new Date(y, m, d, 23, 59, 59, 0);
}
function isExpired() {
  const expiry = parseExpiryDateLocal(EXPIRY_DATE);
  if (!expiry) return false;
  return new Date() > expiry;
}

function showExpiredScreen(msg) {
  document.getElementById('regenBtn').disabled = true;
  document.getElementById('toggleAnim').disabled = true;
  document.getElementById('downloadBtn').disabled = true;
  const overlay = document.getElementById('expiredOverlay');
  overlay.textContent = msg;
  overlay.style.display = 'flex';
  overlay.setAttribute('aria-hidden', 'false');
  // limpa canvas visualmente
  ctx.fillStyle = '#061226';
  ctx.fillRect(0,0,canvas.width,canvas.height);
}
function hideExpiredScreen() {
  const overlay = document.getElementById('expiredOverlay');
  overlay.style.display = 'none';
  overlay.setAttribute('aria-hidden', 'true');
}

/* split text into lines that fit */
function splitTextToLines(textArray, maxWidth) {
  ctx.font = `${FONT_SIZE}px Arial`;
  let lines = [];
  textArray.forEach(text => {
    const words = text.split(/\s+/);
    let cur = '';
    for (let w of words) {
      const test = cur ? cur + ' ' + w : w;
      if (ctx.measureText(test).width <= (maxWidth - 96)) cur = test;
      else { if (cur) lines.push(cur); cur = w; }
    }
    if (cur) lines.push(cur);
  });
  return lines;
}

/* desenho estático — sem jitter, sem rotação */
function drawBackground() {
  ctx.fillStyle = '#061226';
  ctx.fillRect(0,0,canvas.width,canvas.height);
  // leve vinheta
  let g = ctx.createLinearGradient(0,0,0,canvas.height);
  g.addColorStop(0,'rgba(255,255,255,0.02)');
  g.addColorStop(1,'rgba(0,0,0,0.12)');
  ctx.fillStyle = g;
  ctx.fillRect(0,0,canvas.width,canvas.height);
}

function drawWatermark() {
  ctx.save();
  ctx.translate(canvas.width/2, canvas.height/2);
  ctx.rotate(-35 * Math.PI/180);
  ctx.globalAlpha = 0.12;
  ctx.font = '66px Arial';
  ctx.fillStyle = '#ff6b6b';
  ctx.textAlign = 'center';
  ctx.fillText(WATERMARK_TEXT, 0, 0);
  ctx.restore();
  ctx.globalAlpha = 1.0;
}

function renderStatic() {
  drawBackground();
  ctx.fillStyle = '#dff1ff';
  ctx.font = `${FONT_SIZE}px Arial`;
  ctx.textBaseline = 'top';

  const lines = splitTextToLines(TEXT_CONTENT, canvas.width);
  const totalHeight = lines.length * LINE_HEIGHT;
  const startY = (canvas.height - totalHeight) / 2;

  for (let y=0;y<lines.length;y++){
    const line = lines[y];
    const lineWidth = ctx.measureText(line).width;
    const startX = (canvas.width - lineWidth)/2;
    ctx.fillText(line, startX, startY + y*LINE_HEIGHT);
  }

  // um traço diagonal sutil — opcional (removível)
  ctx.globalAlpha = 0.06;
  for (let i=0;i<3;i++){
    ctx.beginPath();
    ctx.lineWidth = 1;
    const off = (i*220) % canvas.width;
    ctx.moveTo(off-300, -40);
    ctx.lineTo(off + 380, canvas.height + 40);
    ctx.strokeStyle = '#07253a';
    ctx.stroke();
  }
  ctx.globalAlpha = 1.0;

  drawWatermark();
}



/* bloqueios mínimos (não infalíveis) */
window.addEventListener("mousedown", function(e) {
  if (e.button === 0) { e.preventDefault(); e.stopPropagation(); return false; }
}, true);

document.addEventListener("keydown", (e)=>{
  if (
    e.key === "F12" ||
    (e.ctrlKey && e.shiftKey && ["I","J","C"].includes(e.key.toUpperCase())) ||
    (e.ctrlKey && e.key.toUpperCase() === "U")
  ) {
    e.preventDefault();
    e.stopPropagation();
    return false;
  }
});

window.addEventListener('contextmenu', e => e.preventDefault());
window.addEventListener('dragstart', e => e.preventDefault());
window.addEventListener('copy', e => e.preventDefault());
window.addEventListener('cut', e => e.preventDefault());

/* checagem de expiração e init */
function init() {
  if (isExpired()) {
    showExpiredScreen("Conteúdo expirado em " + EXPIRY_DATE + ". A página não está mais disponível.");
    return;
  } else {
    hideExpiredScreen();
    renderStatic();
  }
}

/* checar expiração a cada minuto (se quiser atualizar dinamicamente) */
setInterval(function(){
  if (isExpired()) {
    showExpiredScreen("Conteúdo expirado em " + EXPIRY_DATE + ". A página não está mais disponível.");
  }
}, 60 * 1000);

init();
</script>
</body>
</html>
